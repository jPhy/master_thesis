%% 30min talk

\documentclass[english]{beamer}
\usetheme{Warsaw}
\setbeamertemplate{navigation symbols}{} % remove the navigation symbols
\setbeamertemplate{headline}{} % remove headline
\setbeamertemplate{footline}[frame number]

\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage{textcomp}
\usepackage{wasysym}
\usepackage{diagmac2}

\title{Beyond-the-standard-model contributions to rare B decays analyzed with variational-Bayes enhanced adaptive importance sampling}
\author{Stephan Jahn}
\date{\today} %TODO: insert date

% ----------------------------------------------------------------------

\begin{document}

\setbeamercolor{block title}{bg=blue, fg=white}

\newcommand{\slide}[2][t]{\begin{frame}[#1] \frametitle{\insertsection} #2 \end{frame}}
\newcommand{\KLPq}[0]{KL( P\|{}q)}
\newcommand{\varmuN}{var(\mu^{N})}
\newcommand{\wilsoncten }{\mathcal{C} ^{      } _{10}}
\newcommand{\wilsonctenp}{\mathcal{C} ^{\prime} _{10}}
\newcommand{\errorasymm}[3]{#1 \substack{\hspace{.05em} \scriptscriptstyle + \hspace{.05em} #2 \\ \scriptscriptstyle -#3} } % asymmetric uncertainties

% ----------------------- title page, unnumbered -----------------------

{
\setbeamertemplate{footline}{}
\frame[nopagenumbering]{\titlepage}
}

% -------------------------- overview section --------------------------

\section{Overview}

\slide[t]{

    Bayes' formula:
    \newline \newline
    $$ P(\boldsymbol{\theta} | \mathcal{D}, \mathrm{M} ) = \frac{P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})P(\boldsymbol{\theta} | \mathrm{M})}{P(\mathcal{D} | \mathrm{M} )}
       = \frac{P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})P(\boldsymbol{\theta} | \mathrm{M})}{\int P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})P(\boldsymbol{\theta} | \mathrm{M}) d\boldsymbol{\theta} }$$

    \only<2->{ \
        \newline \newline \
        our application: \
        \
        \newline \newline \

        \only<3->{$$ \boldsymbol{\theta} = \lbrace \mathcal{C}_{7 , 9 , 10 , S , P , T , T5}^{(\prime)}  , ... \rbrace $$}
        \only<4->{$$ \mathcal{D} = \mathrm{detector~events} $$}
        \only<5->{$$ \mathrm{M} = \mathrm{EFT , SM , ...} $$}
    }

}


\slide[t]{

{\large\textbf{Goals}}

\begin{columns}[t] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment

\column{.45\textwidth} % Left column and width

\only<2->{\begin{itemize}
              \item draw marginal plots of the posterior
              \
              \newline

              \hspace{-1.2cm} \includegraphics[width=1.01\textwidth]{figures/C10p_CP}

          \end{itemize}}

\column{.5\textwidth} % Right column and width

\only<3->{\begin{itemize}
          \item compare models $\mathrm{EFT} \leftrightarrow \mathrm{SM}$
          \end{itemize}

              $$ \frac{P(\mathrm{EFT}|\mathcal{D})}{P(\mathrm{SM}|\mathcal{D})} =
                 \frac{P(\mathcal{D}|\mathrm{EFT})}{P(\mathcal{D}|\mathrm{SM})} \cdot \frac{P(\mathrm{EFT})}{P(\mathrm{SM})} $$

              $$ P(\mathrm{M} | \mathcal{D} ) = \frac{P(\mathcal{D} | \mathrm{M})P(\mathrm{M})}{P(\mathcal{D})} $$

          \begin{itemize}
          \item[]
              \begin{itemize}
                  \item[] \only<4->{\hspace{-0.1\textwidth} $\frac{P(\mathrm{EFT}|\mathcal{D})}{P(\mathrm{SM}|\mathcal{D})} > 1$ new physics \smiley{} \newline}
                  \item[] \only<5->{\hspace{-0.1\textwidth} $\frac{P(\mathrm{EFT}|\mathcal{D})}{P(\mathrm{SM}|\mathcal{D})} < 1$ confirm SM \frownie{}}
              \end{itemize}
          \end{itemize}}

\end{columns}

}





\slide[t]{

{\large\textbf{Difficulties}}

\begin{columns}[t] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment

\column{.45\textwidth} % Left column and width

\vspace{0.65cm} % to center the text

\only<2->{\begin{itemize}}
\only<2->{\item curse of dimensionality}
\only<3->{\item multimodality}
\only<4->{\item degeneracies}
\only<2->{\end{itemize}}

\only<5->{\Huge \textcolor{red}{no standard algorithm so far}}

\column{.5\textwidth} % Right column and width

\vspace{-8mm}

\begin{center}
\only<3->{\includegraphics[height=0.4\textheight]{figures/C10_C10p}}

\only<4->{\includegraphics[height=0.43\textheight]{figures/example_for_degeneracy}}
\end{center}


\end{columns}

}

% ------------------------------ toc page ------------------------------

\begin{frame}
\frametitle{Contents}
\tableofcontents
\end{frame}

% ----------------------------- VB section -----------------------------

\section{Adaptive importance sampling with the variational-Bayes approach} %TODO: write

\slide{ %TODO: maybe short summary here; importance sampling and variational Bayes then summary at the end

    \textlangle empty\textrangle

}

\subsection{Adaptive importance sampling}

\slide{

    \frametitle{\insertsubsectionhead}

    $$ \int P(x) dx = \int \frac{P(x)}{q(x)} q(x) dx
    \approx \frac{1}{N} \sum^{N}_{i = 1} \frac{P(x_i)}{q(x_i)} \equiv \mu^{{N}} ~~ where ~~ x_i \sim q $$


    \only<2->{squared uncertainty (variance):

    $$ \varmuN = \frac{1}{N} \left[ \int \frac{P(x)}{q(x)} P(x) dx - \left(\int P(x) dx \right)^2 \right] $$}

    \only<3->{\begin{itemize} \item minimize the uncertainty $\varmuN$ with respect to $q$}

        \only<4->{\begin{itemize}
                      \item[--] it suffices to minimize: ~~ $\mathrm{log} \left( \int \frac{P(x)}{q(x)} P(x) dx \right)$}
        \only<5->{    \item[--] by Jensen's inequality:     $\geq \int \mathrm{log} \left( \frac{P(x)}{q(x)} \right) P(x) dx
                                                            \only<6->{\equiv \KLPq}$}
        \only<6->{    \vspace{1.5mm}
                      \item[--] known as the \emph{Kullback-Leibler divergence}}
        \only<4->{\end{itemize}}

    \only<3->{\end{itemize}}
}

\slide{

    \frametitle{\insertsubsectionhead}

    Note:

        \begin{center}
            \begin{tabular}{lcrcc}

                \only<2->{$0 \leq \KLPq$   & and & $  \KLPq = 0$ & $\Leftrightarrow$ & $P=q$ \\}
                \\ % empty row
                \only<3->{$0 \leq \varmuN$ & and & $\varmuN = 0$ & $\Leftrightarrow$ & $P=q$ \\}

            \end{tabular}
        \end{center} \vspace{5mm}

    \only<4->{

      Remember:

        \begin{center}

                \only<4 >{~$\varmuN - const =                         \mathrm{log} \left( \int \frac{P(x)}{q(x)} P(x) dx \right)  \geq \KLPq$}
                \only<5->{ $\varmuN - const = \underbrace{\textstyle{}\mathrm{log} \left( \int \frac{P(x)}{q(x)} P(x) dx \right)} \geq \KLPq$}

        \end{center}

      \only<5->{\vspace{-4mm} \hspace{35mm} \small minimization typically infeasible}

    }

    \only<6->{\vspace{4mm}{}\begin{center}\Large{}\textcolor{red}{minimize $\KLPq$ and hope to approach the unique global minimum $P=q$}{}\end{center}}

}

\subsection{Variational Bayes}

\slide{ %TODO: remove or modify this slide

    \frametitle{\insertsubsectionhead}

    \only<1-2> {placeholder 1}
    \only<2> {placeholder 2}
    \only<-3> {placeholder 3}
    \only<4> {placeholder 4}

}

\slide{ %TODO: remove or modify this slide

    \frametitle{{\fontfamily{qcr}\selectfont pypmc}}

    \vspace{3mm}

    %                                         trim= l b r t  ; crop the (not clickable) link on top and write it below
    \includegraphics[width=\textwidth,page=6, trim= 0 0 0 5cm, clip]{../presentation_22_april/presentation}



    \begin{center}
        \url{https://pypi.python.org/pypi/pypmc}
    \end{center}

}

% ------------------------- B-physics section --------------------------

\section{Scalar and tensor contributions to $ b \to s \mu^+ \mu^- $} %TODO: rewrite

\slide{ %TODO: remove or modify this slide

    \textlangle empty\textrangle

}

% TODO: o explain approach: \theta = {nuisance, Wilson coeff.}; split of P(data, observable(theta,M))
%       o present the 2d marginals as in thesis (only first figure)
%       o mention sensitivity to prior of the form factors --> show plot as in thesis; mention preliminary fits and lattice constraint
%       o mention tighter constraints in models with fixed vectorial Wilson coefficients
%       o show subleading QCDF
%       o calculate Bayes factor
%   => conclusion: need better theoretical control of FF and subleading 1 / m_b to see significant

\slide{ %TODO: need an example of this; maybe branching fraction?

    we want:
    \newline
    $$ P(\boldsymbol{\theta} | \mathcal{D}, \mathrm{M} ) \overset{\mathrm{Bayes}}{\propto} P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})P(\boldsymbol{\theta} | \mathrm{M}) $$
    %  = P(\mathcal{D} | \boldsymbol{O} (\boldsymbol{\theta} , \mathrm{M} ))P(\boldsymbol{\theta} | \mathrm{M}) $$

    \only<2->{

        \vspace{1.6mm}

        split theory and experiment - \emph{observables} $\boldsymbol{O}$:

        $$ P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})
          = P(\mathcal{D} | \boldsymbol{O} (\boldsymbol{\theta} , \mathrm{M} )) $$

        \vspace{-6.5mm}

        \only<3->{

            \begin{center}
                \begin{columns}[t] % the "t" option specifies top vertical alignment

                    \column{.5\textwidth}
                        \begin{block}{\center theory}
                            \begin{center}
                                \only<-3>{ ~ \vspace{8.4mm} ~ }
                                \only<4->{~~~\emph{calculate} observables \newline
                                $ \boldsymbol{O}(\boldsymbol{\theta} , \mathrm{M}) $}
                            \end{center}
                        \end{block}
                        \only<4->{\center \includegraphics[height=1.5cm]{figures/theorist}}

                    \column{.5\textwidth}
                        \begin{block}{\center experiment}
                            \begin{center}
                                \only<-4>{ ~ \vspace{8.4mm} ~ }
                                \only<5->{~~~~~\emph{measure} observables \newline
                                $P\left(\mathcal{D} | \boldsymbol{O} \right)$ }
                            \end{center}
                        \end{block}
                        \only<5->{\center \includegraphics[height=1.5cm]{figures/experimentalist}}

                \end{columns}
            \end{center}
        }

    }

}

\slide{

    example:
    \begin{itemize}
        \item $ \boldsymbol{O} = \mathcal{B} \left( B_s \to \mu ^ + \mu ^ - \right) $, branching fration
        \only<2->{\item $ \mathrm{M} = \mathrm{EFT} $, effective theory for $ b \to s \ell^+ \ell^- $ transitions}
        \only<3->{\item $ \boldsymbol{\theta} = \lbrace \wilsoncten , \wilsonctenp , ... \rbrace$, model parameters}
    \end{itemize}

    \vspace{-3mm}

    \only<4->{\begin{center}
        \begin{columns}[t] % the "t" option specifies top vertical alignment

            \column{.52\textwidth}
                \begin{block}{\center theory}
                    \begin{center}
                        \only<4->{~~~~~~\includegraphics[height=1.5cm]{figures/theo_to_obs}}
                        \newline \only<5->{$ \Rightarrow \mathcal{B} \left( B_s \to \mu ^ + \mu ^ - \right) \propto |\wilsoncten - \wilsonctenp|^2 $}
                        \newline \only<-5>{\vspace{0.96mm}} \only<6->{$ \equiv \boldsymbol{O}(\boldsymbol{\theta} , \mathrm{M}) $}
                    \end{center}
                \end{block}
                \center \href{http://arXiv.org/abs/hep-ph/0104284}{arXiv:hep-ph/0104284}

            \column{.52\textwidth}
                \begin{block}{\center experiment}
                    \begin{center}
                        \only<-6>{ ~ \vspace{25.53mm} ~ }
                        \only<7->{~~~~~\includegraphics[height=1.5cm]{figures/exp_to_obs}
                        \newline \only<8->{$ \Rightarrow \mathcal{B} \left( B_s \to \mu ^ + \mu ^ - \right) = \errorasymm{2.8}{0.7}{0.6} \cdot 10^{-9} $}
                        \newline \only<-8>{\vspace{0.96mm}}\only<9->{$ \equiv P\left(\mathcal{D} | \boldsymbol{O} \right) $}}
                    \end{center}
                \end{block}
                \center \href{http://arXiv.org/abs/1411.4413}{arXiv:1411.4413}

        \end{columns}
    \end{center} }

}

\slide{

    \vspace{-5mm}

    \begin{center}
        \begin{columns}[t] % the "t" option specifies top vertical alignment

            \column{.52\textwidth}
                \begin{block}{\center theory}
                    \begin{center}
                        ~~~~~~\includegraphics[height=1.5cm]{figures/theo_to_obs}
                        \newline $ \boldsymbol{O}(\boldsymbol{\theta} , \mathrm{M}) $
                    \end{center}
                \end{block}

            \column{.52\textwidth}
                \begin{block}{\center experiment}
                    \begin{center}
                        ~~~~~\includegraphics[height=1.5cm]{figures/exp_to_obs}
                        \newline $ P\left(\mathcal{D} | \boldsymbol{O} \right) $
                    \end{center}
                \end{block}

        \end{columns}
    \end{center}

    \vspace{-3mm}

    \[\diagram{
        \vertex 0,30:{}{\border{3pt}{4pt}\rect}
        \vertex 180,30:{}{\border{3pt}{4pt}\rect}
        \only<2->{\vertex 90,0:{P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})}{\border{3pt}{4pt}\rect}}
        \only<3->{\vertex 90,-70:{ \overset{ ~ }{P(\boldsymbol{\theta} | \mathcal{D}, \mathrm{M} )} }{\border{3pt}{4pt}\rect}}
        \only<2->{
            \setedge 0,30,90,0:
            \shadeedge
            \drawsolidedge
            \drawedgehead{100}11
            \setedge 180, 30, 90,0:
            \shadeedge
            \drawsolidedge
            \drawedgehead{100}11
            }
        \only<3->{
            \setedge 90,-10,90,-70:
            \shadeedge
            \drawsolidedge
            \drawedgehead{100}11
            \abutright -35:{\textstyle \mathrm{Bayes}}{\border{2pt}{2pt}\octagon{3pt}}
            }
        }
    \]

    % ~
    % \newline
    % $$ P(\boldsymbol{\theta} | \mathcal{D}, \mathrm{M} ) \overset{\mathrm{Bayes}}{\propto} P(\mathcal{D}|\boldsymbol{\theta}, \mathrm{M})P(\boldsymbol{\theta} | \mathrm{M}) $$

}

\slide{

    % TODO: remove
    % experimentalists' publications provide:
    % \newline \newline
    % $$ P(\mathcal{D} | \boldsymbol{O}) =
    % \int d \boldsymbol{\nu}_{ex} P(\mathcal{D} | \boldsymbol{O} , \boldsymbol{\nu}_{ex}) P(\boldsymbol{\nu}_{ex} | \boldsymbol{O}) $$

    \only<2->{ \
        \newline \newline \
        we define a physical model $\mathrm{M}$ (EFT Lagrangian $ \mathcal{L} $): \
        \
        \newline \newline \

        % TODO: write lagrangian

        that provides

        $$ \boldsymbol{O}( \boldsymbol{\theta} , \mathrm{M} ) $$

        $$ \boldsymbol{\theta} = \lbrace \mathcal{C}_{7 , 9 , 10 , S , P , T , T5 , ...}^{(\prime)} \rbrace $$
        % TODO: comment here: observables have more dependencies, e.g. CKM, quark masses, form factors, ...

        \only<4->{$$ \mathcal{D} = \mathrm{detector~events} $$}


        \only<5->{$$ \mathrm{M} = \mathrm{EFT , SM , ...} $$}
        % TODO: comment here: what are "EFT" and "SM"

     }

}

\slide{

    \begin{center}
        \includegraphics[width=0.7\textwidth]{figures/Wilson_coeff_2d}
    \end{center}

}

\subsection{Scalar contributions}

\slide{ %TODO: remove or modify this slide

    \frametitle{\insertsubsectionhead}

    \only<1-2> {placeholder 1}
    \only<2> {placeholder 2}
    \only<-3> {placeholder 3}
    \only<4> {placeholder 4}

}

\subsection{Tensor contributions}

\slide{ %TODO: remove or modify this slide

    \frametitle{\insertsubsectionhead}

    \only<1-2> {placeholder 1}
    \only<2> {placeholder 2}
    \only<-3> {placeholder 3}
    \only<4> {placeholder 4}

}

\end{document}
